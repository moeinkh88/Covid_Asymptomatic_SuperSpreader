# sensivity

## 
function rep_num1(PP)
    β, l, β′, β´´, κ, ρ₁,	ρ₂,	γₐ,	γᵢ,	γᵣ,	δᵢ,	δₚ, δₕ, δₐ=PP
    ωh=γᵣ+δₕ
    ωp=γₐ+γᵢ+δₚ
    ωi=γₐ+γᵢ+δᵢ
 R = β*ρ₁*(γₐ *l + ωh)/(ωh*ωi) + (1-ρ₁)*(β*γₐ*l + β′ * ωh)/(ωh*ωp)
 return R
end
function rep_num2(PP)
    β, l, β′, β´´, κ, ρ₁,	ρ₂,	γₐ,	γᵢ,	γᵣ,	δᵢ,	δₚ, δₕ, δₐ=PP
    ωh=γᵣ+δₕ
    ωp=γₐ+γᵢ+δₚ
    ωi=γₐ+γᵢ+δᵢ
 R = β*ρ₁*(γₐ *l + ωh)/(ωh*ωi) + ρ₂*(β*γₐ*l + β′ * ωh)/(ωh*ωp) + β´´*(1-ρ₁-ρ₂)/(δₐ)
 return R
end


# M1
par_M1=[3.368739014223833, 1.605375275205752, 0.0, 4.9999999999995355, 0.03658959949393572, 0.6999999999999992, 0.0, 0.1375531965076037, 0.0560295261424954, 0.9179720534039433, 0.044242996045119866, 0.0, 0.003473250106648919, 0.005552315473508071];

# M2
par_M2=[ 3.12996077117126, 1.605375275205752, 7.999999997998878, 0.0, 0.03658959949393572, 0.8760560896249793, 0.25088774743033504, 0.1375531965076037, 0.0560295261424954, 0.9179720534039433, 0.044242996045119866, 0.019687597179891277, 0.003473250106648919, 0.0];

# M3
par_M3=[3.1220651706673066, 1.605375275205752, 5.079230988158643, 4.6830693978875235, 0.03658959949393572, 0.5999999999989443, 0.14999999999962524, 0.1375531965076037, 0.0560295261424954, 0.9179720534039433, 0.044242996045119866, 0.0010000001259533725, 0.003473250106648919, 0.009696038544937498];


# FM1
par_FM1=[ 3.4999999999999996, 1.605375275205752, 0.0, 4.999999999999999, 0.03658959949393572, 0.5999999999999999, 0.0, 0.1375531965076037, 0.0560295261424954, 0.9179720534039433, 0.044242996045119866, 0.0, 0.003473250106648919, 0.00612053486309477]

# FM2
par_FM2=[ 3.4999999999999143, 1.605375275205752, 7.740335211476434, 0.0, 0.03658959949393572, 0.8310642637854406, 0.25088774743033504, 0.1375531965076037, 0.0560295261424954, 0.9179720534039433, 0.044242996045119866, 0.039999999999999966, 0.003473250106648919, 0.0]

# FM3
par_FM3=[ 2.9763470555591796, 1.605375275205752, 7.895865150500946, 2.77222207964141, 0.03658959949393572, 0.5272699408450209, 0.25088774743033504, 0.1375531965076037, 0.0560295261424954, 0.9179720534039433, 0.044242996045119866, 0.001724702577525102, 0.003473250106648919, 0.02042169878603325]

PAR2=hcat(par_M1,par_FM1,par_M2,par_FM2,par_M3,par_FM3)

R02=zeros(size(PAR2))

for j=1:6
    Arg=PAR2[:,j]
        for i in 1:14
            if j==3 || j==4
            Arg1=copy(Arg)
            Arg1[i]=Arg[i]+0.01
            R02[i,j]=(rep_num1(Arg1)-rep_num1(Arg))*Arg[i]/(rep_num1(Arg)*0.01)
            else
                Arg1=copy(Arg)
                Arg1[i]=Arg[i]+0.01
                R02[i,j]=(rep_num2(Arg1)-rep_num2(Arg))*Arg[i]/(rep_num2(Arg)*0.01)
            end
        end
end

function myshowall(io, x, limit = false)
  println(io, summary(x), ":")
  Base.print_matrix(IOContext(io, :limit => limit), x)
end

myshowall(stdout, R02, false)
features=hcat(R02)

using DataFrames
parameters=["β", "l", "β′", "β´´", "κ", "ρ₁",	"ρ₂",	"γₐ",	"γᵢ",	"γᵣ",	"δᵢ",	"δₚ", "δₕ", "δₐ"]

df=DataFrame(Parameters=parameters, M1=features[:,1], FM1=features[:,2],M2=features[:,3], FM2=features[:,4],M3=features[:,5], FM3=features[:,6])

show(IOContext(stdout, :limit=>false), df)
